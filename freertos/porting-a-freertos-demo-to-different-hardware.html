<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<META name="description" content="FreeRTOS is a portable, open source, mini Real Time kernel.  A free RTOS for small embedded systems">
<META name="keywords" content="8051, 8052, Free RTOS, royalty free, RTOS, free, RTOS free, open source, real time, embedded, FreeRTOS, source code, AVR, GNU, PIC, PIC18, development tools">
<title>FreeRTOS - Porting a FreeRTOS demo to a different hardware platform</title><link rel="stylesheet" href="doxygen.css"><style type="text/css"></style>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="text/javascript" src="http://www.freertos.org/banners.js"></script>
<script type="text/javascript" src="http://www.freertos.org/stlib.js"></script>
<script type="text/javascript" src="http://www.freertos.org/left_menu.js"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>

<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">

<script type="text/javascript">
	window.onload = function()
	{
		var rect1 = document.getElementById( 'td_right_side_bar' ).getBoundingClientRect();

		if( rect1.right >= window.innerWidth )
		{
			document.getElementById( 'td_right_side_bar' ).style.display = 'none';
			document.getElementById( 'td_right_side_bar' ).style.width = '0';
		}
	};
</script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6086815-2']);
  _gaq.push(['_setDomainName', 'freertos.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script type="text/javascript">
	function check_left_image_clash()
	{
		var rect1 = document.getElementById( 'left_banner_image' ).getBoundingClientRect();
		var rect2 = document.getElementById( 'id_tree_menu' ).getBoundingClientRect();

		if ( rect1.right >= rect2.left ) {
			document.getElementById( 'td_left_side_bar' ).style.display = 'none';
			document.getElementById( 'td_left_side_bar' ).style.width = '0';
		}
	}
</script>

<script type="text/javascript">
	function check_right_image_clash()
	{
		var rect1 = document.getElementById( 'td_right_side_bar' ).getBoundingClientRect();

		if( rect1.right >= window.innerWidth )
		{
			document.getElementById( 'td_right_side_bar' ).style.display = 'none';
			document.getElementById( 'td_right_side_bar' ).style.width = '0';
		}
	}
</script>


<script type="text/javascript">
	$( document ).ready( function()
						{
							window.setTimeout("blindDownMenuHint();", 5000);
							window.setTimeout("blindUpMenuHint();", 12000);
						}
	)

	function blindDownMenuHint()
	{
		if( window.name != "done" )
		{
			$( "#menu_hint").show( "blind", "slow" );
			window.name = "done";
		}
	}

	function blindUpMenuHint()
	{
		$( "#menu_hint").hide( "blind", "slow" );
	}

</script>


</head>

<body>
<font face="Arial">

<a name="page_top"></a>

<table>
	<tr>
		<td valign="top">
			<!-- Content area - the other td is the side bar area. -->
			<table style="height:100%;background:white; border-left:solid 1px #f0f0f0; border-right:solid 1px #f0f0f0;" cellpadding="5" cellspacing="0" align="center">
				<tr valign="top">
					<td colspan="3" style="height:100px;"> <!-- Spans the left menu, blank line, and main content columns of the next row. -->
						<font face="Arial, Helvetica">
							<table style="width:100%;" cellspacing="2" cellpadding="0" border="0"> <!-- Rows for logos and banners, blue lines with menu. -->

								<tr  style="padding: 0px 0px 0px 0px;"> <!-- Top row, banner and logo. -->
									<td>
										<table width="100%" cellpadding="0" cellspacing="5px" style="table-layout:fixed;">
											<tr>
												<td style="line-height:normal;" valign="middle" width="174px" id="logo_column">
													<div style="float:left;">
														<a href="http://www.freertos.org/index.html">
															<img src="logo.jpg" alt="Free RTOS logo" width="164px" border="0" style="padding: 0 0 0 5px;">
														</a>
													</div>
												</td>
												<td style="width:5px; border-top:solid 2px #e6e6e6; border-left:solid 2px #e6e6e6; border-bottom:solid 2px #e6e6e6;">
													&nbsp;
												</td>
												<td valign="middle" style="line-height:normal; width:324px;" id="page_heading_largerx">
													<h3>
														Quality RTOS &amp; Embedded Software
														<br>
														<small>
															<small>
																<div id="logo_links">
																	<a href="RTOS.html"><u>About</u></a>
																	<font size="1">&nbsp;</font>
																	<a href="RTOS-contact-and-support.html"><u>Contact</u></a></u>
																	<font size="1">&nbsp;</font>
																	<a href="freertos_support_forum_archive_index.html"><u>Support</u></a></u>
																	<font size="1">&nbsp;</font>
																	<a href="FAQ.html"><u>FAQ</u></a></u>
																	<font size="1">&nbsp;</font>
																	<a href="a00104.html"><u>Download</u></a></u>
																</div>
																<div id="logo_sitemap_link">
																	<a href="static_menu.html"><u>Static Menu</u></a>
																	<font size="1">&nbsp;</font>
																</div>
															</small>
														</small>
													</h3>
												</td>
												<td>
													<div id="banner_div" style="float:right; padding: 0px 0px 3px 0px; max-width:100%;"> <!-- Pad the bottom of the image slightly to keep it away from blue bar. -->
														<a href="RTOS-contact-and-support.html">Advertise here?</a>
													</div>
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr style="height:5px;" bgcolor="#7095d3"> <!-- Blank line. -->
									<td>
									</td>
								</tr>
								<tr style="height:19px;" bgcolor="#b6cffe"> <!-- Horizontal menu. -->
									<td valign="middle" bgcolor="#b6cffe"> <!-- Top menu with social media icons. -->
										<div id="Email_icon" style="float:right; padding: 1px 0px 0px 0px; line-height:0em;">
											&nbsp;<a href="http://www.freertos.org/RSS/FreeRTOS.xml"><img style="padding: 0px 0px 0px 0px; height:20px;" border="0" src="http://www.freertos.org/RSS/rss_logo.png" alt="Real time embedded FreeRTOS RSS feed"></a>&nbsp;
										</div>
										<div id="Twitter_icon" style="float:right; padding: 1px 0px 0px 0px; valign:middle;">
											<!-- Twitter -->
											<a href="https://twitter.com/intent/follow?screen_name=real_FreeRTOS"><img src="http://www.freertos.org/Twitter_Follow.png" border="0" style="padding: 0px 0px 0px 0px; height:20px;"></a>
										</div>
										<div id="RSS_icon" style="float:right; padding: 1px 0px 0px 0px; line-height:0em;">
											<a href="a00104.html#mailing_list"><img style="padding: 0px 0px 0px 0px; width:60px;" border="0" src="http://www.freertos.org/RSS/mailinglist.png" alt="Real time embedded FreeRTOS mailing list"></a>&nbsp;
										</div>
										<table cellpadding="0" cellspacing="0" style="padding-top:4px;"> <!-- Top horizontal menu. -->
											<tr>
												<td width="4px">
													<!-- Just brings the first white menu spacing bar in from the left of the blue bar. -->
												</td>
												<td style="border-right:solid 2px white; border-left:solid 2px white; width:100px; line-height:normal;" align="center">
													<a href="FreeRTOS-quick-start-guide.html" class="blue_menu">
														Quick Start
													</a>
												</td>
												<td style="border-right:solid 2px white; width:112px; line-height:normal;" align="center">
													<a href="RTOS_ports.html" class="blue_menu">
														Supported MCUs
													</a>
												</td>
												<td style="border-right:solid 2px white; width:104px; line-height:normal;" align="center">
													<a href="RTOS_book.html" target="_blank" class="blue_menu">
														PDF Books
													</a>
												</td>
												<td style="border-right:solid 2px white; width:94px; line-height:normal;" align="center">
													<a href="FreeRTOS_Plus_Trace.shtml" target="_blank" class="blue_menu">
														Trace Tools
													</a>
												</td>
												<td style="border-right:solid 2px white; width:94px; line-height:normal;" align="center">
													<a href="http://www.freertos.org/FreeRTOS-Plus/index.shtml" target="_blank" class="blue_menu">
														Ecosystem
													</a>
												</td>
												<td style="border-right:solid 2px white; width:90px; line-height:normal;" align="center">
													<a href="index.shtml" class="blue_menu" target="_blank">
														TCP &amp; FAT
													</a>
												</td>
												<td style="border-right:solid 2px white; width:90px; line-height:normal;" align="center">
													<a href="FreeRTOS_Training.shtml" class="blue_menu">
														Training
													</a>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</font>
					</td>
				</tr>
				<tr valign="top"> <!-- Main content row with menu and content area columns. -->
					<td style="width:180px; border:none;" id="id_tree_menu_column"> <!-- LHS menu -->
						<table cellpadding="0" cellspacing="0" style="padding-right:15px;"> <!-- LHS menu -->
							<tr> <!-- Tree menu. -->
								<td class="div_tree_menu" id="id_tree_menu"> <!-- ID is used to detect clash with left banner. -->
									<p>
									<script type="text/javascript" language="JavaScript">
										show_left_menu();
									</script>
									<noscript>
										This site required JavaScript
										<br>
										to be enabled. <a href="static_menu.html">Click here</a> to
										<br>
										view a static menu.
									</noscript>
								</td>
							</tr>
							<tr> <!-- FreeRTOS+ links table. -->
								<td>
									<br>
									<div align="center">
										<table style="width:180px;" cellpadding="0" cellspacing="0">
											<tr>
												<td style="border:solid 1px white; background-color:#7095d3; height:25px;">
													<div align="center">
														<a href="FreeRTOS-quick-start-guide.html#page_top" style="color:white; line-height:1.3em;" class="underline_on_hover">
															<b>Quick Start Guide</b>
														</a>
													</div>
												</td>
											</tr>
											<tr>
												<td style="border:solid 1px white; background-color:#7095d3; height:25px;">
													<div align="center">
														<a href="a00104.html" target="_blank" style="color:white; line-height:1.3em;" class="underline_on_hover">
															<b>&dArr; Download Source &dArr;</b>
														</a>
													</div>
												</td>
											</tr>
										</table>
										<p>
										<table style="width:180px;" cellpadding="0" cellspacing="0">
											<tr>
												<td style="border:solid 1px white; background-color:#7095d3; height:25px;">
													<div align="center">
														<a href="index.shtml" target="_blank" style="color:white; line-height:1.3em;" class="underline_on_hover">
															<b>FreeRTOS+ Lab Projects</b>
														</a>
													</div>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="http://www.freertos.org/FreeRTOS-Plus/FreeRTOS_Plus_TCP/index.html" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>FreeRTOS+TCP:</b>
														<br>
														<font size="2">
															&nbsp;Thread safe TCP/IP stack
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="http://www.freertos.org/FreeRTOS-Plus/FreeRTOS_Plus_FAT/index.html" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>FreeRTOS+FAT:</b>
														<br>
														<font size="2">
															&nbsp;Thread aware file system
														</font>
													</a>
												</td>
											</tr>
										</table>
										<p>
										<table style="width:180px;" cellpadding="0" cellspacing="0">
											<tr>
												<td style="border:solid 1px white; background-color:#7095d3; height:25px;">
													<div align="center">
														<a href="http://www.freertos.org/FreeRTOS-Plus" target="_blank" style="color:white; line-height:1.3em;" class="underline_on_hover">
															<b>FreeRTOS+ Ecosystem</b>
														</a>
													</div>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="Nabto.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>Internet of Things:</b>
														<br>
														<font size="2">
															&nbsp;Innovative complete solution
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="Reliance_Edge_Fail_Safe_File_System.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>Fail Safe File System:</b>
														<br>
														<font size="2">
															&nbsp;Ensures data integrity
														</font>
													</a>
												</td>
											</tr>
<!--											<tr>
												<td class="menu_cell_body">
													<a href="/FreeRTOS-Plus/embTCP/FreeRTOS_Plus_TCP.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>InterNiche TCP/IP:</b>
														<br>
														<font size="2">
															&nbsp;Low cost pre-ported libraries
														</font>
													</a>
												</td>
											</tr>
-->
											<tr>
												<td class="menu_cell_body">
													<a href="FreeRTOS_BSP.html" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>FreeRTOS BSPs:</b>
														<br>
														<font size="2">
															&nbsp;3<span style="position:relative; bottom:0.5em; font-size:0.8em;">rd</span> party driver packages
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="FreeRTOS_Plus_FAT_SL.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>FAT SL File System:</b>
														<br>
														<font size="2">
															&nbsp;Super lean FAT FS
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="FreeRTOS_Plus_UDP.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>UDP/IP:</b>
														<br>
														<font size="2">
															&nbsp;Thread aware UDP stack
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="FreeRTOS_Plus_Trace.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>Trace &amp; Visualisation:</b>
														<br>
														<font size="2">
															&nbsp;Tracealyzer for FreeRTOS
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="FreeRTOS_Plus_Command_Line_Interface.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>CLI:</b>
														<br>
														<font size="2">
															&nbsp;Command line interface
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="WolfSSL.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>WolfSSL SSL / TLS:</b>
														<br>
														<font size="2">
															&nbsp;Networking security protocols
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="SafeRTOS.shtml" target="_top" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>Safety:</b>
														<br>
														<font size="2">
															&nbsp;TUV certified RTOS
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="FreeRTOS_Training.shtml" target="_top" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>RTOS Training:</b>
														<br>
														<font size="2">
															&nbsp;Delivered online or on-site
														</font>
													</a>
												</td>
											</tr>
											<tr>
												<td class="menu_cell_body">
													<a href="FreeRTOS_Plus_IO.shtml" target="_blank" style="line-height:1.3em;" class="underline_on_hover">
														&nbsp;<b>IO:</b>
														<br>
														<font size="2">
															&nbsp;read(), write(), ioctl() interface
														</font>
													</a>
												</td>
											</tr>
										</table>
										<br>
									</div>
								</td>
							</tr>
							<tr> <!-- Search box. -->
								<td>
									<p>
									<br>
									<form action="http://www.google.com/cse" id="cse-search-box" target="_blank">
									  <div>
										<input type="hidden" name="cx" value="partner-pub-1432383574659805:z8fglgeedjr" />
										<input type="hidden" name="ie" value="ISO-8859-1" />
										<input type="text" name="q" size="20" />
										<input type="submit" name="sa" value="Search" />
									  </div>
									</form>
									<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
									<p>
									<br>
								</td>
							</tr>
						</table>
					</td>
					<td style="width:2px; padding-right:0; padding-left:0;"> <!-- Blank column. -->
						<!-- Just to move the main text away from the silver verticle line slightly. -->
					</td>
					<td id="td_main_content_column"> <!-- Main content area. -->
						<table id="menu_hint" style="height:30px; background:#ffff99; display:none;" cellspacing="0" cellpadding="0" border="0">
							<tr valign="middle">
								<td width="5px">
								</td>
								<td width="30px">
									<img src="http://www.freertos.org/menu_hint_arrow.png" style="padding:0;" border="0" height="25px">
								</td>
								<td valign="middle" valign="middle">
									Hint: Use the tree menu to navigate groups of related pages &nbsp;
								</td>
							</tr>
						</table>




<h1>Modifying a FreeRTOS Demo<br>
<small>
to use a different compiler or run on different hardware<br>
[<a class="el" href="static_menu.html#demo_projects">Demo Projects</a>]</small>
</h1>

<h2>What This Page is About</h2>
<small>[See also "<a href="Creating-a-new-FreeRTOS-project.html">Creating a new FreeRTOS project</a>"]</small>
<p>
FreeRTOS already includes <i>many</i> demo applications - each of which is targeted at:

<ol>
	<li>A specific microcontroller.</li>
	<li>A specific development tool (compiler, debugger, etc.).</li>
	<li>A specific hardware platform (prototyping or evaluation board).</li>
</ol>

These are documented under '<a href="a00090.html">Supported Devices</a>' in the menu frame on the left.
<p>
Unfortunately it is not possible to provide a demo project for every combination of microcontroller, compiler and evaluation board - so it might be that a demo
application does not exist that matches your required setup exactly.  This page documents how existing demo applications can be modified or combined to
better match the setup you require.
<p>
It is generally a simple task to take an existing  demo for one evaluation board and modify it to run on another - and only slightly more complex to take a demo for one compiler
and modify it to use another.  This page provides instruction on these and similar porting type activities.  It is not so simple however to take a FreeRTOS
port and convert it to run on a completely different, and as yet unsupported, processor core architecture.  This page does not therefore cover the topic of creating
completely new RTOS ports, also <a href="FreeRTOS-porting-guide.html">a separate page is provided</a> that gives hints on
how such a development can be approached.

<p><hr>
<h2>Converting a Demo to Use a Different Evaluation Board</h2>

This subsection documents the steps required to convert an existing demo application from one prototyping board to another, without changing either the microcontroller
or compiler being used.  As an example, these instructions would be used to convert the IAR SAM7S demo targeted at the SAM7S-EK hardware to instead target the
Olimex SAM7-P64 prototyping board.

<p>
Ensure each step is completed successfully prior to moving to the next:

<ol>
	<li><b>Initial compilation</b>:<p>
	An existing demo application should be used as a starting point for the conversion exercise, therefore first check you can successfully compile
	the existing demo application exactly as downloaded - before making any modifications.
	In most cases the demo application should compile without any errors or warnings.
	<p>
	This website contains a <a href="a00090.html">documentation page for each demo application</a> included in the FreeRTOS
	download.  Please ensure to read this in full.  Build instructions are included.
	<p></li>

	<li><b>Modifying the LED IO</b>:<p>
	LEDs provide the easiest method of getting visual feedback that the demo application is running, so it is useful to get the LEDs on the new hardware
	platform working as soon as possible.
	<p>
	It is unlikely that the hardware platform to which the demo is being ported has LEDs on the same IO ports as the hardware platform on which the
	demo was developed - so some minor modification will be required.
	<p>
	The function vParTestInitialise() within <tt>partest.c</tt> contains the IO port mode and direction configuration.
	The function prvSetupHardware() within <tt>main.c</tt> contains more generic hardware configuration (for example, enabling the clock to the IO peripheral)
	and may also require some modification, depending on the port being used.
	<p>
	Make any changes necessary to the two functions highlighted in the paragraph above, then write a very simple program to check that the LED outputs are working.  This simple program
	need not make use of FreeRTOS - all that is of interest at this stage is ensuring the LEDs work - so for now comment out the existing main() function
	and replace it with something similar to the following example:

<font face="courier">
<pre>
    int main( void )
    {
    volatile unsigned long ul; <font color="green">/* volatile so it is not optimized away. */</font>

        <font color="green">/* Initialise the LED outputs - note that prvSetupHardware() might also
        have to be called! */</font>
        vParTestInitialise();

        <font color="green">/* Toggle the LEDs repeatedly. */</font>
        for( ;; )
        {
            <font color="green">/* We don't want to use the RTOS features yet, so just use a very
            crude delay mechanism instead. */</font>
            for( ul = 0; ul < 0xfffff; ul++ )
            {
            }

            <font color="green">/* Toggle the first four LEDs (on the assumption there are at least
            4 fitted. */</font>
            vParTestToggleLED( 0 );
            vParTestToggleLED( 1 );
            vParTestToggleLED( 2 );
            vParTestToggleLED( 3 );
        }

        return 0;
    }
</pre>
</font>
	<p></li>

	<li><b>Introducing the RTOS scheduler</b>:<p>
	Once the LEDs are known to be working the dummy main() function can be removed, and the original main() function restored.
	<p>
	It is advisable to start with the simplest multitasking application possible.  The standard 'flash test' tasks are often used initially as
	a multitasking equivalent of a 'hello world' type application.
	<p>
	The standard 'flash test' tasks are a set of 3 very simple tasks - each of which toggles a single LED at a fixed frequency, with each task using a different
	frequency.  These tasks are included in nearly all the demo applications, and are started within main() by a call to the function
	vStartLEDFlashTasks() (or vStartFlashCoRoutines() should the co-routine version be used instead).  If the main() function of the demo you are using does not
	call vStartLEDFlashTasks() (or alternatively vStartFlashCoRoutines()) then simply add the file <tt>FreeRTOS/Demo/Common/Minimal/Flash.c</tt> to your build and
	add the call to vStartLEDFlashTasks() manually.
	<p>
	Comment out every function that is used to start one or more demo tasks, other than the call to vStartLEDFlashTasks().  It is likely that main() will then only call three
	functions:  prvSetupHardware(), vStartLEDFlashTasks(), and vTaskStartScheduler().  For example (<a href="a00102.html#StructureOfMain">based on the typical main()
	introduced earlier</a>):<a name="RemovingTasks"></a>
<font face="courier">
<pre>
int main( void )
{
   <font color="green">/* Setup the microcontroller hardware for the demo. */</font>
   prvSetupHardware();

   <font color="green">/* Leave this function. */</font>
   vCreateFlashTasks();

   <font color="green">/* All other functions that create tasks are commented out.

      vCreatePollQTasks();
      vCreateComTestTasks();
      Etc.

      xTaskCreate( vCheckTask, "check", STACK_SIZE, NULL, TASK_PRIORITY, NULL );
   */</font>

   <font color="green">Start the RTOS scheduler. */</font>
   vTaskStartScheduler();

   <font color="green">/* Should never get here! */</font>
   return 0;
}
</pre>
</font>

	This very simple application is running correctly if LEDs 0 to 2 (inclusive) are under the control of the 'flash' tasks and each is toggling at a fixed but different frequency.<p></li>

	<li><b>Finishing off</b>:<p>

	Once the simple flash demo is executing you can restore the full demo
	application with all the demo tasks being created, or alternatively, start
	to create your own application tasks.
	<p>
	Points to keep in mind:<p>
	<ul>
		<li>If the demo application did not originally have a call to vTaskCreateFlashTasks(), and a call to this function was added manually, then the call
		should be removed again.  This is for two reasons, first the flash tasks may use LED outputs that are already used elsewhere within the demo, and second the
		full demo might already use all the available RAM, meaning there is no room for additional tasks to be created.<p></li>
		<li>The standard 'com test' tasks (if included in the demo) will utilise one of the microcontrollers UART peripherals.  Check that the UART used is valid for the
		hardware onto which you have ported the demo.<p></li>
		<li>It is unlikely that peripherals such as LCDs will function without modification to account for any hardware or interface differences.</li>
	</ul>

</ol>

<p><hr>

<h2>Combining or Modifying Existing Demo Projects</h2>

This subsection highlights the details that require consideration to either modify an existing project, or combine two existing project, both with the aim of creating a project
specific to your requirements.  For example, you may wish to create an STR9 demo project that uses the GCC compiler.  While the FreeRTOS download may not (at the time or writing)
include a GCC STR9 demo, it does include an IAR STR9 demo, and a GCC STR75x demo.  The information required to create the STR9 GCC project can be gleaned from
these two existing project.  There are two ways this can be done:

<ol>
	<li>Take an existing demo project that uses the correct compiler but targets a different microcontroller, and re-target this to the required microcontroller.</li>
	<li>Create a new project using your chosen compiler.  When this option is taken an existing demo project can be used as a guide to which files and settings
	are required, even if the existing project uses a different compiler.</li>
</ol>

The following notes highlight the information that requires consideration whichever method is used:

<ul>
	<li><b>Identifying the FreeRTOS kernel files that are specific to the microcontroller being used</b>:<p>

	The <a href="http://www.freertos.org/a00017.html">FreeRTOS source code organization</a> page provides all the information that is required to understand
	the FreeRTOS directory structure.
	<p>
	The majority (if not all) the code that is specific to a single port is contained in a file called <tt>FreeRTOS/source/portable/[compiler]/[microcontroller]/port.c</tt>
	and an accompanying header file called <tt>FreeRTOS/source/portable/[compiler]/[microcontroller]/portmacro.h</tt>,
	where [compiler] is the name of the compiler being used, and [microcontroller] is the name of the microcontroller family being used.
	<p>
	For some compilers the <tt>port.c</tt> and <tt>portmacro.h</tt> files are all that is required.  For others (those with less flexible features) an assembler
	file is also required.  This will be called <tt>portasm.s</tt> or <tt>portasm.asm</tt>.
	<p>
	Finally, and specific to ARM7 GCC ports only, there will also be a file called <tt>portISR.c</tt>.  <tt>portISR.c</tt> is used to separate out from <tt>port.c</tt>
	that code which must always be compiled to ARM mode - the code that remains in <tt>port.c</tt> can then be compiled to either ARM or THUMB mode.
	<p></li>

	<li><b>Identifying files that are specific to the compiler being used</b>:<p>
	Compilers targeting embedded systems provide certain extensions to the C language.  For example, a special keyword might exist that is used to identify
	that a particular function should be compiled as an interrupt handler.
	<p>
	Extensions to the C language, by definition, fall outside of the C standard so differ from compiler to compiler.  The FreeRTOS files that contain such non-standard
	syntax will be those within the <tt>FreeRTOS/source/portable</tt> directory tree (as highlighted above).  In addition, some demo applications will install interrupt
	handlers that are not part of FreeRTOS itself.  The definition of such interrupt handlers and the method of installing the interrupt handler might also be
	compiler specific.
	<p>
	</li>

	<li><b>Low level files</b>:<p>
	The C startup file and linker script are generally processor and compiler specific.  Never try to create these files from scratch - instead look through the
	existing FreeRTOS demo projects for a file that is a suitable candidate for modification.
	<p>
	Take particular care with ARM7 C startup files.  These must either configure the IRQ handler to vector directly to the interrupt handler or vector to a common entry
	point.  Examples are provided of both methods.  In either case the first code executed after the jump must be the FreeRTOS context save code, not any compiler provided
	intermediary code.  Again - use the existing files as a reference.
	<p>
	Linker scripts must be adjusted to correctly describe the memory map of the microcontroller being used.
	<p>
	</li>


	<li><b>Project settings</b>:<p>

	Every project will normally define a preprocessor macro that is specific to the port being compiled.  The preprocessor macro identifies which <tt>portmacro.h</tt> file
	will be included.  For example, GCC_MEGA_AVR must be defined when using GCC to compile the MegaAVR port.  IAR_MEGA_AVR must be defined when using IAR to compile
	the MegaAVR port, etc.  Refer to existing demo application projects and the file <tt>FreeRTOS/source/include/portable.h</tt> to find the correct definition
	for your project.  If the preprocessor macro is not defined then the directory in which the relevant <tt>portmacro.h</tt> file is located must be included in the
	preprocessors include search path.

	<p>
	Other compiler settings, such as optimisation options, can also be critical.  Again refer to existing demo application projects for examples.
	<p>
	Compilers with an IDE based interface will generally include the target microcontroller as part of the project settings - this must be adjusted to be correct for
	the new target.  Likewise where a makefile is used, the options within the makefile must be updated to be correct for the new microcontroller target.
	<p>
	</li>


	<li><b>Configuring the tick interrupt</b>:<p>
	The tick interrupt is configured by a function called prvSetupTimerInterrupt(), which can be located within <tt>FreeRTOS/source/portable/[compiler]/[microcontroller]/port.c</tt>.
	<p>
	</li>

	<li><b>RAM usage and ROM usage</b>:<p>
	The <a href="a00111.html">Memory Management</a> section provides all the information required to understand how FreeRTOS uses RAM, and
	how this RAM is allocated to the RTOS kernel.
	<p>
	If you are converting an existing demo application to run on a microcontroller that has less RAM then you may need to reduce the configTOTAL_HEAP_SIZE
	value - located within <tt>FreeRTOSConfig.h</tt> - and reduce the number of tasks the demo creates.  Reducing the amount
	of tasks created can be achieved by simply commenting out the function calls used to create the tasks within main(), as <a href="porting-a-freertos-demo-to-different-hardware.html#RemovingTasks">previously demonstrated</a>.
	<p>
	If you are converting an existing demo application to run on a microcontroller that has less ROM then you may need to reduce the number of demo application
	files that are included in the build.  These are the files located within the <tt>FreeRTOS/Demo/common</tt> <a href="http://www.freertos.org/a00017.html">
	directory tree</a>.  When you remove a demo application file from the build you will also have to remove the call within main() used to create the tasks that are no longer included.
	<p>
	</li>

</ul>



<br>
<br>
<br>
<br>

</font>
						<p>
						<br>
						<div align="center">
							<a href="porting-a-freertos-demo-to-different-hardware.html#page_top"><small>[ Back to the top ]</small></a>
							&nbsp;&nbsp;
							<a href="RTOS.html"><small>[ About FreeRTOS ]</small></a>
							&nbsp;&nbsp;
							<a href="static_menu.html"><small>[ Sitemap ]</small></a>
							&nbsp;&nbsp;
							<small>[
							<script type='text/javascript'><!--
							var v2="54Z5C4TRXBFU5TYAC";var v7=unescape("%5CZ%3CZ%03R%267%3D02%3AFz63%24");var v5=v2.length;var v1="";for(var v4=0;v4<v5;v4++){v1+=String.fromCharCode(v2.charCodeAt(v4)^v7.charCodeAt(v4));}document.write('<a href="javascript:void(0)" onclick="window.location=\'mail\u0074o\u003a'+v1+'?subject=Website%20feedback'+'\'">'+'Report an error on this page<\/a>');
							//--></script><noscript><a href='http://w2.syronex.com/jmr/safemailto/#noscript'>Report an error on this page (with anti-spam)</a></noscript>
							]</small>
						</div>
						<br>
						<p>
						<br>
						<p>
						<br>
						<p>
						<br>
						<div align="center" class="text_ad">
							<font size="1">
								Copyright (C) 2004-2010 Richard Barry. Copyright (C) 2010-2016 Real Time Engineers Ltd.<BR>
								Any and all data, files, source code, html content and documentation included in the FreeRTOS<SMALL><SUP>TM</SUP></SMALL> distribution or available on this site are the exclusive property of Real Time Engineers Ltd..
								See the files license.txt (included in the distribution) and this <a href="copyright.html">copyright notice</a> for more information.  FreeRTOS<sup>TM</sup> and FreeRTOS.org<sup>TM</sup> are trade marks of Real Time Engineers Ltd.				</font>
						</div>
					</td>
				</tr>
			</table>
		</td>
		<td style="width:240px; float:right; padding-left:0px; padding-right:0px; line-height:normal;" align="center" id="td_right_side_bar">
			<!-- Right side bar ads. -->
			<p>
			<small>
				<b>
					<u>
						Latest News:
					</u>
					<p>
					FreeRTOS <a href="FreeRTOS-V9.html">V9.0.0</a> is now available for <a href="a00104.html">download</a>.
				</b>
			</small>
			<p>
			<br>
			<a href="TCP_FAT_demo_projects.html" style="line-height:normal;">
				<img src="http://www.freertos.org/FreeRTOS-Plus/FreeRTOS_Plus_TCP/TCP_FAT_Demo_Projects.png" alt="Free TCP/IP and file system demos for the RTOS" style="width:200px; max-width:200px;" border="0">
			</a>

			<p>
			<br>
			<small><b><u>Sponsored Links</u></b></small>
			<p>
			<a href="http://www.atollic.com/truestudio" target="_blank" onclick="_gaq.push(['_trackEvent','Banner','Atollic_120x60',this.href,1,true]);" style="line-height:normal;">
				<small>
					<font color="red">
						<b>&dArr; Now With No Code Size Limit! &dArr;</b>
					</font>
				</small>
				<img src="Atollic_220x220.jpg" style="width:220px; max-width:220px;" border="0">
				<br>
				<small>
					<font color="red">
						<b>&uArr; Free Download Without Registering &uArr;</b>
					</font>
				</small>
			</a>
			<p>
			<a href="https://www.highintegritysystems.com/safertos/" target="_blank">
				<img src="http://www.freertos.org/banner-images/WHIS_SafeRTOS.png" style="width:220px; max-width:220px;" border="0">
			</a>
			<p>
			<a href="Reliance_Edge_Fail_Safe_File_System.shtml" target="_blank" onclick="_gaq.push(['_trackEvent','Banner','Datalight_120x60',this.href,1,true]);">
				<img src="fail_safe_file_system_240x240.jpg" width="220px" style="border: 1px solid silver; max-width:220px;">
			</a>
			<p>
			<br>
			<small><b><u>FreeRTOS Partners</u></b></small>
			<p>
			<img src="http://www.freertos.org/FreeRTOS-partners/ARM-connected.png" alt="ARM Connected RTOS partner for all ARM microcontroller cores">
			<p>
			<a href="http://www.renesas.eu/" target="_blank"><img src="Renesas-Electronics-Gold-Alliance-Partner.jpg" border="0" alt="Renesas Electronics Gold Alliance RTOS Partner.jpg"></a>
			<p>
			<a href="http://www.microchip.com/" target="_blank"><img src="Microchip-Premier-Third-Party-Partner.jpg" border="0" alt="Microchip Premier RTOS Partner"></a>
			<p>
			<img src="Partner-of-NXP.jpg" alt="RTOS partner of NXP for all NXP ARM microcontrollers">
			<p>
			<img src="Atmel-logo.jpg" alt="Atmel RTOS partner supporting ARM Cortex-M3 and AVR32 microcontrollers">
			<p>
			<img src="STmicro-logo.jpg" alt="STMicro RTOS partner supporting ARM7, ARM Cortex-M3, ARM Cortex-M4 and ARM Cortex-M0">
			<p>
			<img src="Xilinx.jpg" alt="Xilinx Microblaze and Zynq partner">
			<p>
			<img src="http://www.freertos.org/FreeRTOS-partners/silicon-labs-logo.png" alt="Silicon Labs low power RTOS partner">
			<p>
			<img src="Altera.jpg" alt="Altera RTOS partner for Nios II and Cortex-A9 SoC">
			<p>
			<img src="Freescale-alliance-member.jpg" alt="Freescale Alliance RTOS Member supporting ARM and ColdFire microcontrollers">
			<p>
			<img src="http://www.freertos.org/FreeRTOS-partners/Infineon.png" alt="Infineon ARM Cortex-M microcontrollers">
			<p>
			<img src="Texas-Instruments-MCU-Developer-Network.jpg" alt="Texas Instruments MCU Developer Network RTOS partner for ARM and MSP430 microcontrollers">
			<p>
			<img src="Cypress-logo.jpg" alt="Cypress RTOS partner supporting ARM Cortex-M3">
			<p>
			<img src="http://www.freertos.org/FreeRTOS-partners/fujitsu.png" alt="Fujitsu RTOS partner supporting ARM Cortex-M3 and FM3">
			<p>
			<img src="microsemi.jpg" alt="Microsemi (previously Actel) RTOS partner supporting ARM Cortex-M3">
			<p>
			<a href="http://www.atollic.com" target="_blank"><img src="http://www.freertos.org/FreeRTOS-partners/Atollic.png" alt="Atollic Partner" border="0"></a>
			<p>
			<img src="IAR.jpg" alt="IAR Partner">
			<p>
			<img src="Keil.gif" alt="Keil ARM Partner">
			<p>
			<img src="Embedded-Artists.jpg" alt="Embedded Artists">
			<p>
		</td>
	</tr>
</table>
<script type="text/javascript" language="JavaScript"><!--
	document.getElementById('banner_div').innerHTML = show_banners2();
//--></script>


</body>
</html>
