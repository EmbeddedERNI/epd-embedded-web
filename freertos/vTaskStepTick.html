
<html>
  <head>
    <meta content="HTML Tidy for HTML5 for Linux version 5.2.0" name="generator"/>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="FreeRTOS API reference documentation for vTaskStepTick()." name="description"/>
    <meta content="low power, tickless, tick less, RTOS" name="keywords"/>
    <title>Low power FreeRTOS helper function</title>

    <link href="doxygen.css" rel="stylesheet"/>
    <style type="text/css"><![CDATA[
]]></style>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <script src="banners.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="stlib.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="left_menu.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"><![CDATA[
]]></script>
    <link href="code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css" rel="stylesheet"/>
    <script type="text/javascript"><![CDATA[
        window.onload = function()
        {
                var rect1 = document.getElementById( 'td_right_side_bar' ).getBoundingClientRect();

                if( rect1.right >= window.innerWidth )
                {
                        document.getElementById( 'td_right_side_bar' ).style.display = 'none';
                        document.getElementById( 'td_right_side_bar' ).style.width = '0';
                }
        };
]]></script>
    <script type="text/javascript"><![CDATA[
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6086815-2']);
  _gaq.push(['_setDomainName', 'freertos.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
]]></script>
    <script type="text/javascript"><![CDATA[
        function check_left_image_clash()
        {
                var rect1 = document.getElementById( 'left_banner_image' ).getBoundingClientRect();
                var rect2 = document.getElementById( 'id_tree_menu' ).getBoundingClientRect();

                if ( rect1.right >= rect2.left ) {
                        document.getElementById( 'td_left_side_bar' ).style.display = 'none';
                        document.getElementById( 'td_left_side_bar' ).style.width = '0';
                }
        }
]]></script>
    <script type="text/javascript"><![CDATA[
        function check_right_image_clash()
        {
                var rect1 = document.getElementById( 'td_right_side_bar' ).getBoundingClientRect();

                if( rect1.right >= window.innerWidth )
                {
                        document.getElementById( 'td_right_side_bar' ).style.display = 'none';
                        document.getElementById( 'td_right_side_bar' ).style.width = '0';
                }
        }
]]></script>
    <script type="text/javascript"><![CDATA[
        $( document ).ready( function()
                                                {
                                                        window.setTimeout("blindDownMenuHint();", 5000);
                                                        window.setTimeout("blindUpMenuHint();", 12000);
                                                }
        )

        function blindDownMenuHint()
        {
                if( window.name != "done" )
                {
                        $( "#menu_hint").show( "blind", "slow" );
                        window.name = "done";
                }
        }

        function blindUpMenuHint()
        {
                $( "#menu_hint").hide( "blind", "slow" );
        }

]]></script></head>

  <body><font face="Arial"><a id="page_top" name="page_top"/></font>
    <table>
      <tbody>
        <tr>
          <td valign="top">
            <!-- Content area - the other td is the side bar area. -->
            <table align="center" cellpadding="5" cellspacing="0" style="height:100%;background:white; border-left:solid 1px #f0f0f0; border-right:solid 1px #f0f0f0;">
              <tbody>
                <tr valign="top">
                  <td colspan="3" style="height:100px;">
                    <!-- Spans the left menu, blank line, and main content columns of the next row. -->

                    <table border="0" cellpadding="0" cellspacing="2" style="width:100%;"><!-- Rows for logos and banners, blue lines with menu. -->

                      <tbody>
                        <tr style="padding: 0px 0px 0px 0px;"><!-- Top row, banner and logo. -->

                          <td>
                            <table cellpadding="0" cellspacing="5px" style="table-layout:fixed;" width="100%">
                              <tbody>
                                <tr>
                                  <td id="logo_column" style="line-height:normal;" valign="middle" width="174px">
                                    <div style="float:left;"><a href="index.html"><img alt="Free RTOS logo" border="0" src="logo.jpg" style="padding: 0 0 0 5px;" width="164px"/></a></div>
                                  </td>

                                  <td style="width:5px; border-top:solid 2px #e6e6e6; border-left:solid 2px #e6e6e6; border-bottom:solid 2px #e6e6e6;"> &nbsp;</td>

                                  <td id="page_heading_largerx" style="line-height:normal; width:324px;" valign="middle">
                                    <h3>Quality RTOS &amp; Embedded
                                      Software<br/>
                                    </h3>

                                    
                                  </td>

                                  <td>
                                    
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                        </tr>

                        <tr bgcolor="#7095D3" style="height:5px;"><!-- Blank line. -->

                          <td/>
                        </tr>

                        <tr bgcolor="#B6CFFE" style="height:19px;"><!-- Horizontal menu. -->

                          <td bgcolor="#B6CFFE" valign="middle">
                            <!-- Top menu with social media icons. -->
                            

                            

                            

                            <table cellpadding="0" cellspacing="0" style="padding-top:4px;"><!-- Top horizontal menu. -->

                              <tbody>
                                <tr>
                                  <td width="4px">
                                    <!-- Just brings the first white menu spacing bar in from the left of the blue bar. --></td>

                                  <td align="center" style="border-right:solid 2px white; border-left:solid 2px white; width:100px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:112px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:104px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:94px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:94px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:90px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:90px; line-height:normal;"/>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>

                <tr valign="top"><!-- Main content row with menu and content area columns. -->

                  

                  <td style="width:2px; padding-right:0; padding-left:0;"> <!-- Blank column. -->
                    <!-- Just to move the main text away from the silver verticle line slightly. --></td>

                  <td id="td_main_content_column"><!-- Main content area. -->
                    <table border="0" cellpadding="0" cellspacing="0" id="menu_hint" style="height:30px; background:#ffff99; display:none;">
                      <tbody>
                        <tr valign="middle">
                          <td width="5px"/>

                          <td width="30px"><img border="0" height="25px" src="menu_hint_arrow.png" style="padding:0;"/></td>

                          <td valign="middle">Hint: Use the tree menu
                            to navigate groups of related pages &nbsp;</td>
                        </tr>
                      </tbody>
                    </table>

                    <h1>vTaskStepTick<br/>
                      <small>[<a class="el" href="a00020.html">RTOS
                      Kernel Control</a>]</small></h1>
                    task.h
                    <pre><font face="courier">
 void vTaskStepTick( TickType_t xTicksToJump );
</font></pre>

                    <p>If the RTOS is configured to use <a href="low-power-tickless-rtos.html">tickless
                      idle functionality</a> then the tick interrupt
                      will be stopped, and the microcontroller placed
                      into a low power state, whenever the Idle task is
                      the only task able to execute. Upon exiting the
                      low power state the tick count value must be
                      corrected to account for the time that passed
                      while it was stopped.</p>

                    <p>If a FreeRTOS port includes a default <a href="low-power-tickless-rtos.html">portSUPPRESS_TICKS_AND_SLEEP()</a>
                      implementation, then vTaskStepTick() is used
                      internally to ensure the correct tick count value
                      is maintained. vTaskStepTick() is a public API
                      function to allow the default
                      portSUPPRESS_TICKS_AND_SLEEP() implementation to
                      be overridden, and for a
                      portSUPPRESS_TICKS_AND_SLEEP() to be provided if
                      the port being used does not provide a default.</p>

                    <p>The configUSE_TICKLESS_IDLE configuration
                      constant must be set to 1 for vTaskStepTick() to
                      be available.</p>

                    <dl compact="compact">
                      <dt><b>Parameters:</b></dt>

                      <dd>
                        <table border="0" cellpadding="0" cellspacing="10">
                          <tbody>
                            <tr>
                              <td valign="top"><font face="arial"><em>xTicksToJump</em></font> &nbsp;</td>

                              <td><font face="arial">The number of
                                RTOS ticks that have passed since the
                                tick interrupt was stopped. For correct
                                operation the parameter must be less
                                than or equal to the
                                portSUPPRESS_TICKS_AND_SLEEP()
                                parameter.</font></td>
                            </tr>
                          </tbody>
                        </table>
                      </dd>
                    </dl>

                    <dl compact="compact">
                      <dt><b>Returns:</b></dt>

                      <dd>None.</dd>
                    </dl>
                    <b>Example usage:</b>
                    <p>The example shows calls being made to several
                      functions. Only vTaskStepTick() is part of the
                      FreeRTOS API. The other functions are specific to
                      the clocks and power saving modes available on
                      the hardware in use, and as such, must be
                      provided by the application writer.</p>

                    <pre>
<font color="green">/* First define the portSUPPRESS_TICKS_AND_SLEEP().  The parameter is the time,
in ticks, until the kernel next needs to execute. */</font>
#define portSUPPRESS_TICKS_AND_SLEEP( xIdleTime ) vApplicationSleep( xIdleTime )

<font color="green">/* Define the function that is called by portSUPPRESS_TICKS_AND_SLEEP(). */</font>
void vApplicationSleep( TickType_t xExpectedIdleTime )
{
unsigned long ulLowPowerTimeBeforeSleep, ulLowPowerTimeAfterSleep;

    <font color="green">/* Read the current time from a time source that will remain operational
    while the microcontroller is in a low power state. */</font>
    ulLowPowerTimeBeforeSleep = ulGetExternalTime();

    <font color="green">/* Stop the timer that is generating the tick interrupt. */</font>
    prvStopTickInterruptTimer();

    <font color="green">/* Configure an interrupt to bring the microcontroller out of its low power
    state at the time the kernel next needs to execute.  The interrupt must be
    generated from a source that is remains operational when the microcontroller
    is in a low power state. */</font>
    vSetWakeTimeInterrupt( xExpectedIdleTime );

    <font color="green">/* Enter the low power state. */</font>
    prvSleep();

    <font color="green">/* Determine how long the microcontroller was actually in a low power state
    for, which will be less than xExpectedIdleTime if the microcontroller was
    brought out of low power mode by an interrupt other than that configured by
    the vSetWakeTimeInterrupt() call.  Note that the scheduler is suspended
    before portSUPPRESS_TICKS_AND_SLEEP() is called, and resumed when
    portSUPPRESS_TICKS_AND_SLEEP() returns.  Therefore no other tasks will
    execute until this function completes. */</font>
    ulLowPowerTimeAfterSleep = ulGetExternalTime();

    <font color="green">/* Correct the kernels tick count to account for the time the microcontroller
    spent in its low power state. */</font>
    vTaskStepTick( ulLowPowerTimeAfterSleep ï¿½ ulLowPowerTimeBeforeSleep );

    <font color="green">/* Restart the timer that is generating the tick interrupt. */</font>
    prvStartTickInterruptTimer();
}
</pre>
                    <br/>
                    <br/>
                    <br/>
                    <br/>
                    <br/>

                    <p><br/>
                    </p>

                    <div align="center"><a href="#page_top"><small>[
                      Back to the top ]</small></a> &nbsp;&nbsp; <a href="RTOS.html"><small>[ About FreeRTOS
                      ]</small></a> &nbsp;&nbsp; <a href="static_menu.html"><small>[ Sitemap
                      ]</small></a> &nbsp;&nbsp; <small>[
                      <script type="text/javascript"><![CDATA[
<!--
                                                        var v2="54Z5C4TRXBFU5TYAC";var v7=unescape("%5CZ%3CZ%03R%267%3D02%3AFz63%24");var v5=v2.length;var v1="";for(var v4=0;v4<v5;v4++){v1+=String.fromCharCode(v2.charCodeAt(v4)^v7.charCodeAt(v4));}document.write('<a href="javascript:void(0)" onclick="window.location=\'mail\u0074o\u003a'+v1+'?subject=Website%20feedback'+'\'">'+'Report an error on this page<\/a>');
                                                        //-->
]]></script></small>
                      <noscript/>
                      <a href="http://w2.syronex.com/jmr/safemailto/#noscript">Report an error on this page (with anti-spam)</a> ]</div>
                    <br/>

                    <p><br/>
                    </p>

                    <p><br/>
                    </p>

                    <p><br/>
                    </p>

                    <div align="center" class="text_ad"><font size="1">Copyright (C) 2004-2010 Richard Barry. Copyright
                      (C) 2010-2016 Real Time Engineers Ltd.<br/>
                      Any and all data, files, source code, html
                      content and documentation included in the
                      FreeRTOS<small><sup>TM</sup></small>
                      distribution or available on this site are the
                      exclusive property of Real Time Engineers Ltd..
                      See the files license.txt (included in the
                      distribution) and this <a href="copyright.html">copyright notice</a> for more information.
                      FreeRTOS<sup>TM</sup> and FreeRTOS.org<sup>TM</sup> are trade marks of Real Time Engineers
                      Ltd.</font></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </td>

          
        </tr>
      </tbody>
    </table>

    <script language="JavaScript" type="text/javascript"><![CDATA[
<!--
        document.getElementById('banner_div').innerHTML = show_banners2();
//-->
]]></script></body>
</html>
