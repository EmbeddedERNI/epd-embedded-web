
<html>
  <head>
    <meta content="HTML Tidy for HTML5 for Linux version 5.2.0" name="generator"/>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="Send an RTOS task notification from an interrupt service routine (ISR)" name="description"/>
    <meta content="RTOS, task, thread, notification" name="keywords"/>
    <title>xTaskNotifyFromISR() Real Time Operating System API
      documentation</title>

    <link href="doxygen.css" rel="stylesheet"/>
    <style type="text/css"><![CDATA[
]]></style>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <script src="/banners.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="/stlib.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="/left_menu.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"><![CDATA[
]]></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"><![CDATA[
]]></script>
    <link href="//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css" rel="stylesheet"/>
    <script type="text/javascript"><![CDATA[
        window.onload = function()
        {
                var rect1 = document.getElementById( 'td_right_side_bar' ).getBoundingClientRect();

                if( rect1.right >= window.innerWidth )
                {
                        document.getElementById( 'td_right_side_bar' ).style.display = 'none';
                        document.getElementById( 'td_right_side_bar' ).style.width = '0';
                }
        };
]]></script>
    <script type="text/javascript"><![CDATA[
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6086815-2']);
  _gaq.push(['_setDomainName', 'freertos.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
]]></script>
    <script type="text/javascript"><![CDATA[
        function check_left_image_clash()
        {
                var rect1 = document.getElementById( 'left_banner_image' ).getBoundingClientRect();
                var rect2 = document.getElementById( 'id_tree_menu' ).getBoundingClientRect();

                if ( rect1.right >= rect2.left ) {
                        document.getElementById( 'td_left_side_bar' ).style.display = 'none';
                        document.getElementById( 'td_left_side_bar' ).style.width = '0';
                }
        }
]]></script>
    <script type="text/javascript"><![CDATA[
        function check_right_image_clash()
        {
                var rect1 = document.getElementById( 'td_right_side_bar' ).getBoundingClientRect();

                if( rect1.right >= window.innerWidth )
                {
                        document.getElementById( 'td_right_side_bar' ).style.display = 'none';
                        document.getElementById( 'td_right_side_bar' ).style.width = '0';
                }
        }
]]></script>
    <script type="text/javascript"><![CDATA[
        $( document ).ready( function()
                                                {
                                                        window.setTimeout("blindDownMenuHint();", 5000);
                                                        window.setTimeout("blindUpMenuHint();", 12000);
                                                }
        )

        function blindDownMenuHint()
        {
                if( window.name != "done" )
                {
                        $( "#menu_hint").show( "blind", "slow" );
                        window.name = "done";
                }
        }

        function blindUpMenuHint()
        {
                $( "#menu_hint").hide( "blind", "slow" );
        }

]]></script></head>

  <body><font face="Arial"><a id="page_top" name="page_top"/></font>
    <table>
      <tbody>
        <tr>
          <td valign="top">
            <!-- Content area - the other td is the side bar area. -->
            <table align="center" cellpadding="5" cellspacing="0" style="height:100%;background:white; border-left:solid 1px #f0f0f0; border-right:solid 1px #f0f0f0;">
              <tbody>
                <tr valign="top">
                  <td colspan="3" style="height:100px;">
                    <!-- Spans the left menu, blank line, and main content columns of the next row. -->

                    <table border="0" cellpadding="0" cellspacing="2" style="width:100%;"><!-- Rows for logos and banners, blue lines with menu. -->

                      <tbody>
                        <tr style="padding: 0px 0px 0px 0px;"><!-- Top row, banner and logo. -->

                          <td>
                            <table cellpadding="0" cellspacing="5px" style="table-layout:fixed;" width="100%">
                              <tbody>
                                <tr>
                                  <td id="logo_column" style="line-height:normal;" valign="middle" width="174px">
                                    <div style="float:left;"><a href="/index.html"><img alt="Free RTOS logo" border="0" src="logo.jpg" style="padding: 0 0 0 5px;" width="164px"/></a></div>
                                  </td>

                                  <td style="width:5px; border-top:solid 2px #e6e6e6; border-left:solid 2px #e6e6e6; border-bottom:solid 2px #e6e6e6;"> &nbsp;</td>

                                  <td id="page_heading_largerx" style="line-height:normal; width:324px;" valign="middle">
                                    <h3>Quality RTOS &amp; Embedded
                                      Software<br/>
                                    </h3>

                                    
                                  </td>

                                  <td>
                                    
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                        </tr>

                        <tr bgcolor="#7095D3" style="height:5px;"><!-- Blank line. -->

                          <td/>
                        </tr>

                        <tr bgcolor="#B6CFFE" style="height:19px;"><!-- Horizontal menu. -->

                          <td bgcolor="#B6CFFE" valign="middle">
                            <!-- Top menu with social media icons. -->
                            

                            

                            

                            <table cellpadding="0" cellspacing="0" style="padding-top:4px;"><!-- Top horizontal menu. -->

                              <tbody>
                                <tr>
                                  <td width="4px">
                                    <!-- Just brings the first white menu spacing bar in from the left of the blue bar. --></td>

                                  <td align="center" style="border-right:solid 2px white; border-left:solid 2px white; width:100px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:112px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:104px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:94px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:94px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:90px; line-height:normal;"/>

                                  <td align="center" style="border-right:solid 2px white; width:90px; line-height:normal;"/>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>

                <tr valign="top"><!-- Main content row with menu and content area columns. -->

                  

                  <td style="width:2px; padding-right:0; padding-left:0;"> <!-- Blank column. -->
                    <!-- Just to move the main text away from the silver verticle line slightly. --></td>

                  <td id="td_main_content_column"><!-- Main content area. -->
                    <table border="0" cellpadding="0" cellspacing="0" id="menu_hint" style="height:30px; background:#ffff99; display:none;">
                      <tbody>
                        <tr valign="middle">
                          <td width="5px"/>

                          <td width="30px"><img border="0" height="25px" src="/menu_hint_arrow.png" style="padding:0;"/></td>

                          <td valign="middle">Hint: Use the tree menu
                            to navigate groups of related pages &nbsp;</td>
                        </tr>
                      </tbody>
                    </table>

                    <h1>xTaskNotifyFromISR()<br/>
                      <small>[<a class="el" href="/RTOS-task-notification-API.html">RTOS
                      Task Notification API</a>]</small></h1>

                    <p><br/>
                      task.h</p>

                    <pre><font face="courier">
 BaseType_t xTaskNotifyFromISR( TaskHandle_t xTaskToNotify,
                                uint32_t ulValue,
                                eNotifyAction eAction,
                                BaseType_t *pxHigherPriorityTaskWoken );
</font></pre>

                    <p><small>[If you are using RTOS task
                      notifications to implement binary or counting
                      semaphore type behaviour then use the simpler <a href="/vTaskNotifyGiveFromISR.html">vTaskNotifyGiveFromISR()</a> API function
                      instead of xTaskNotifyFromISR()]</small></p>

                    <p>A version of <a href="xTaskNotify.html">xTaskNotify()</a> that can be called from an
                      ISR.</p>

                    <p>Each RTOS task has a 32-bit <a href="/RTOS-task-notifications.html">notification value</a> which is initialised to
                      zero when the RTOS task is created.
                      xTaskNotifyFromISR() is used to send an event
                      directly to and potentially unblock an RTOS task,
                      and optionally update the receiving task's
                      notification value in one of the following ways:</p>

                    <ul>
                      <li>Write a 32-bit number to the notification
                        value</li>

                      <li>Add one (increment) the notification value</li>

                      <li>Set one or more bits in the notification
                        value</li>

                      <li>Leave the notification value unchanged</li>
                    </ul>

                    <dl compact="compact">
                      <dt><b>Parameters:</b></dt>

                      <dd>
                        <table border="0" cellpadding="0" cellspacing="10">
                          <tbody>
                            <tr>
                              <td valign="top"><font face="arial"><em>xTaskToNotify</em></font> &nbsp;</td>

                              <td><font face="arial">The handle of
                                the RTOS task being notified. This is
                                the <i>subject</i> task.</font>
                                <p><font face="arial">To obtain a
                                  task's handle create the task using
                                  <a href="/a00125.html">xTaskCreate()</a> and make use of
                                  the pxCreatedTask parameter, or
                                  create the task using <a href="/xTaskCreateStatic.html">xTaskCreateStatic()</a> and store
                                  the returned value, or use the task's
                                  name in a call to <a href="/a00021.html#xTaskGetHandle">xTaskGetHandle()</a>.</font></p>

                                <p><font face="arial">The handle of
                                  the currently executing RTOS task is
                                  returned by the <a href="/a00021.html#xTaskGetCurrentTaskHandle">xTaskGetCurrentTaskHandle()</a> API
                                  function.</font></p>
                              </td>
                            </tr>

                            <tr>
                              <td valign="top"><font face="arial"><em>ulValue</em></font> &nbsp;</td>

                              <td><font face="arial">Used to update
                                the notification value of the subject
                                task. See the description of the
                                eAction parameter below.</font></td>
                            </tr>

                            <tr>
                              <td valign="top"><font face="arial"><em>eAction</em></font> &nbsp;</td>

                              <td><font face="arial">An enumerated
                                type that can take one of the values
                                documented in the table below in order
                                to perform the associated action.</font></td>
                            </tr>

                            <tr>
                              <td valign="top"><font face="arial"><em>pxHigherPriorityTaskWoken</em></font> &nbsp;</td>

                              <td><font face="arial">*pxHigherPriorityTaskWoken must be
                                initialised to 0.</font>
                                <p><font face="arial">xTaskNotifyFromISR() will set
                                  *pxHigherPriorityTaskWoken to pdTRUE
                                  if sending the notification caused a
                                  task to unblock, and the unblocked
                                  task has a priority higher than the
                                  currently running task.</font></p>

                                <p><font face="arial">If
                                  xTaskNotifyFromISR() sets this value
                                  to pdTRUE then a context switch
                                  should be requested before the
                                  interrupt is exited. See the example
                                  below.</font></p>

                                <p><font face="arial">pxHigherPriorityTaskWoken is an
                                  optional parameter and can be set to
                                  NULL.</font></p>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </dd>
                    </dl>

                    <table cellpadding="5px">
                      <tbody>
                        <tr style="height:40px;">
                          <td class="light_blue_table_cell">eAction
                            Setting</td>

                          <td class="light_blue_table_cell">Action
                            Performed</td>
                        </tr>

                        <tr>
                          <td valign="top">eNoAction</td>

                          <td>The subject task receives the event, but
                            its notification value is not updated. In
                            this case ulValue is not used.</td>
                        </tr>

                        <tr>
                          <td valign="top">eSetBits</td>

                          <td>The notification value of the subject
                            task will be bitwise ORed with ulValue. For
                            example, if ulValue is set to 0x01, then
                            bit 0 will get set within the subject
                            task's notification value. Likewise if
                            ulValue is 0x04 then bit 2 will get set in
                            the subject task's notification value. In
                            this way the RTOS task notification
                            mechanism can be used as a light weight
                            alternative to an <a href="/FreeRTOS-Event-Groups.html">event
                            group</a>.</td>
                        </tr>

                        <tr>
                          <td valign="top">eIncrement</td>

                          <td>The notification value of the subject
                            task will be incremented by one, making the
                            call to xTaskNotifyFromISR() equivalent to
                            a call to <a href="vTaskNotifyGiveFromISR.html">vTaskNotifyGiveFromISR()</a>. In this
                            case ulValue is not used.</td>
                        </tr>

                        <tr>
                          <td valign="top">eSetValueWithOverwrite</td>

                          <td>The notification value of the subject
                            task is unconditionally set to ulValue. In
                            this way the RTOS task notification
                            mechanism is being used as a light weight
                            alternative to <a href="/xQueueOverwrite.html">xQueueOverwrite()</a>.</td>
                        </tr>

                        <tr>
                          <td valign="top">eSetValueWithoutOverwrite</td>

                          <td>If the subject task does not already
                            have a notification pending then its
                            notification value will be set to ulValue.
                            <p>If the subject task already has a
                              notification pending then its
                              notification value is not updated as to
                              do so would overwrite the previous value
                              before it was used. In this case the call
                              to xTaskNotify() fails.</p>

                            <p>In this way the RTOS task notification
                              mechanism is being used as a light weight
                              alternative to <a href="/a00117.html">xQueueSend()</a> on a queue of length
                              1.</p>
                          </td>
                        </tr>
                      </tbody>
                    </table>

                    <dl compact="compact">
                      <dt><b>Returns:</b></dt>

                      <dd>pdPASS is returned in all cases other than
                        when eAction is set to
                        eSetValueWithoutOverwrite and the subject
                        task's notification value cannot be updated
                        because the subject task already had a
                        notification pending.</dd>
                    </dl>

                    <p><br/>
                      <b>Example usage:</b></p>

                    <p><small>[More examples are referenced from the
                      main <a href="/RTOS-task-notifications.html">RTOS task notifications page</a>]</small></p>

                    <p>This example demonstrates how to use
                      xTaskNotifyFromISR() with the eSetBits action.
                      See the <a href="/xTaskNotify.html">xTaskNotify()</a> API documentation page for
                      examples showing how to use the eNoAction,
                      eSetValueWithOverwrite and
                      eSetValueWithoutOverwrite actions.</p>

                    <pre><font face="courier">

<font color="green">/* The interrupt handler does not perform any processing itself.  Instead it
it unblocks a high priority task in which the events that generated the
interrupt are processed.  If the priority of the task is high enough then the
interrupt will return directly to the task (so it will interrupt one task but
return to a different task), so the processing will occur contiguously in time -
just as if all the processing had been done in the interrupt handler itself.
The status of the interrupting peripheral is sent to the task using an RTOS task
notification. */</font>
void vANInterruptHandler( void )
{
BaseType_t xHigherPriorityTaskWoken;
uint32_t ulStatusRegister;

    <font color="green">/* Read the interrupt status register which has a bit for each interrupt
    source (for example, maybe an Rx bit, a Tx bit, a buffer overrun bit, etc. */</font>
    ulStatusRegister = ulReadPeripheralInterruptStatus();

    <font color="green">/* Clear the interrupts. */</font>
    vClearPeripheralInterruptStatus( ulStatusRegister );

    <font color="green">/* xHigherPriorityTaskWoken must be initialised to pdFALSE.  If calling
    xTaskNotifyFromISR() unblocks the handling task, and the priority of
    the handling task is higher than the priority of the currently running task,
    then xHigherPriorityTaskWoken will automatically get set to pdTRUE. */</font>
    xHigherPriorityTaskWoken = pdFALSE;

    <font color="green">/* Unblock the handling task so the task can perform any processing necessitated
    by the interrupt.  xHandlingTask is the task's handle, which was obtained
    <a href="/a00125.html">when the task was created</a>.  The handling task's notification value
    is bitwise ORed with the interrupt status - ensuring bits that are already
    set are not overwritten. */</font>
    xTaskNotifyFromISR( xHandlingTask,
                        ulStatusRegister,
                        eSetBits,
                        &amp;xHigherPriorityTaskWoken );

    <font color="green">/* Force a context switch if xHigherPriorityTaskWoken is now set to pdTRUE.
    The macro used to do this is dependent on the port and may be called
    portEND_SWITCHING_ISR. */</font>
    portYIELD_FROM_ISR( xHigherPriorityTaskWoken );
}
<font color="green">/* ----------------------------------------------------------- */</font>

<font color="green">/* A task that blocks waiting to be notified that the peripheral needs servicing,
processing all the events pending in the peripheral each time it is notified to
do so. */</font>
void vHandlingTask( void *pvParameters )
{
uint32_t ulInterruptStatus;

    for( ;; )
    {
        <font color="green">/* Block indefinitely (without a timeout, so no need to check the function's
        return value) to wait for a notification.  NOTE!  Real applications
        should not block indefinitely, but instead time out occasionally in order
        to handle error conditions that may prevent the interrupt from sending
        any more notifications. */</font>
        <a href="/xTaskNotifyWait.html">xTaskNotifyWait</a>( 0x00,               <font color="green">/* Don't clear any bits on entry. */</font>
                         ULONG_MAX,          <font color="green">/* Clear all bits on exit. */</font>
                         &amp;ulInterruptStatus, <font color="green">/* Receives the notification value. */</font>
                         portMAX_DELAY );    <font color="green">/* Block indefinitely. */</font>

        <font color="green">/* Process any bits set in the received notification value.  This assumes
        the peripheral sets bit 1 for an Rx interrupt, bit 2 for a Tx interrupt,
        and bit 3 for a buffer overrun interrupt. */</font>
        if( ( ulInterruptStatus &amp; 0x01 ) != 0x00 )
        {
            prvProcessRxInterrupt();
        }

        if( ( ulInterruptStatus &amp; 0x02 ) != 0x00 )
        {
            prvProcessTxInterrupt();
        }

        if( ( ulInterruptStatus &amp; 0x04 ) != 0x00 )
        {
            prvClearBufferOverrun();
        }
    }
}

</font></pre>
                    <br/>
                    <br/>
                    <br/>
                    <br/>
                    <br/>

                    <p><br/>
                    </p>

                    <div align="center"><a href="#page_top"><small>[
                      Back to the top ]</small></a> &nbsp;&nbsp; <a href="/RTOS.html"><small>[ About FreeRTOS
                      ]</small></a> &nbsp;&nbsp; <a href="/static_menu.html"><small>[ Sitemap
                      ]</small></a> &nbsp;&nbsp; <small>[
                      <script type="text/javascript"><![CDATA[
<!--
                                                        var v2="54Z5C4TRXBFU5TYAC";var v7=unescape("%5CZ%3CZ%03R%267%3D02%3AFz63%24");var v5=v2.length;var v1="";for(var v4=0;v4<v5;v4++){v1+=String.fromCharCode(v2.charCodeAt(v4)^v7.charCodeAt(v4));}document.write('<a href="javascript:void(0)" onclick="window.location=\'mail\u0074o\u003a'+v1+'?subject=Website%20feedback'+'\'">'+'Report an error on this page<\/a>');
                                                        //-->
]]></script></small>
                      <noscript/>
                      <a href="http://w2.syronex.com/jmr/safemailto/#noscript">Report an error on this page (with anti-spam)</a> ]</div>
                    <br/>

                    <p><br/>
                    </p>

                    <p><br/>
                    </p>

                    <p><br/>
                    </p>

                    <div align="center" class="text_ad"><font size="1">Copyright (C) 2004-2010 Richard Barry. Copyright
                      (C) 2010-2016 Real Time Engineers Ltd.<br/>
                      Any and all data, files, source code, html
                      content and documentation included in the
                      FreeRTOS<small><sup>TM</sup></small>
                      distribution or available on this site are the
                      exclusive property of Real Time Engineers Ltd..
                      See the files license.txt (included in the
                      distribution) and this <a href="/copyright.html">copyright notice</a> for more information.
                      FreeRTOS<sup>TM</sup> and FreeRTOS.org<sup>TM</sup> are trade marks of Real Time Engineers
                      Ltd.</font></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </td>

          
        </tr>
      </tbody>
    </table>

    <script language="JavaScript" type="text/javascript"><![CDATA[
<!--
        document.getElementById('banner_div').innerHTML = show_banners2();
//-->
]]></script></body>
</html>
