

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>IDF Monitor &mdash; ESP-IDF Programming Guide v3.0-dev-806-gde750e9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="../about.html"/>
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="ESP-IDF Programming Guide v3.0-dev-806-gde750e9 documentation" href="../index.html"/>
        <link rel="up" title="Get Started" href="index.html"/>
        <link rel="next" title="Customized Setup of Toolchain" href="toolchain-setup-scratch.html"/>
        <link rel="prev" title="Eclipse IDE on Windows" href="eclipse-setup-windows.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ESP-IDF Programming Guide
          

          
          </a>

          
            
            
              <div class="version">
                v3.0-dev-806-gde750e9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Get Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#what-you-need">What You Need</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#guides">Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#setup-toolchain">Setup Toolchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#get-esp-idf">Get ESP-IDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#setup-path-to-esp-idf">Setup Path to ESP-IDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#start-a-project">Start a Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#connect">Connect</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#configure">Configure</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#build-and-flash">Build and Flash</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#monitor">Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#updating-esp-idf">Updating ESP-IDF</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#related-documents">Related Documents</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="add-idf_path-to-profile.html">Add IDF_PATH to User Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="establish-serial-connection.html">Establish Serial Connection with ESP32</a></li>
<li class="toctree-l3"><a class="reference internal" href="make-project.html">Build and Flash with Make</a></li>
<li class="toctree-l3"><a class="reference internal" href="eclipse-setup.html">Build and Flash with Eclipse IDE</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="idf-monitor.html#">IDF Monitor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="idf-monitor.html#interacting-with-idf-monitor">Interacting With idf_monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="idf-monitor.html#automatically-decoding-addresses">Automatically Decoding Addresses</a></li>
<li class="toctree-l4"><a class="reference internal" href="idf-monitor.html#launch-gdb-for-gdbstub">Launch GDB for GDBStub</a></li>
<li class="toctree-l4"><a class="reference internal" href="idf-monitor.html#quick-compile-and-flash">Quick Compile and Flash</a></li>
<li class="toctree-l4"><a class="reference internal" href="idf-monitor.html#quick-reset">Quick Reset</a></li>
<li class="toctree-l4"><a class="reference internal" href="idf-monitor.html#simple-monitor">Simple Monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="idf-monitor.html#known-issues-with-idf-monitor">Known Issues with idf_monitor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="toolchain-setup-scratch.html">Customized Setup of Toolchain</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api-reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hw-reference/index.html">H/W Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-guides/index.html">API Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COPYRIGHT.html">Copyrights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ESP-IDF Programming Guide</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Get Started</a> &raquo;</li>
        
      <li>IDF Monitor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/get-started/idf-monitor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="idf-monitor">
<h1>IDF Monitor<a class="headerlink" href="idf-monitor.html#idf-monitor" title="Permalink to this headline">¶</a></h1>
<p>The idf_monitor tool is a Python program which runs when the <code class="docutils literal"><span class="pre">make</span> <span class="pre">monitor</span></code> target is invoked in IDF.</p>
<p>It is mainly a serial terminal program which relays serial data to and from the target device&#8217;s serial port, but it has some other IDF-specific xfeatures.</p>
<div class="section" id="interacting-with-idf-monitor">
<h2>Interacting With idf_monitor<a class="headerlink" href="idf-monitor.html#interacting-with-idf-monitor" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Ctrl-]</span></code> will exit the monitor.</li>
<li><code class="docutils literal"><span class="pre">Ctrl-T</span> <span class="pre">Ctrl-H</span></code> will display a help menu with all other keyboard shortcuts.</li>
<li>Any other key apart from <code class="docutils literal"><span class="pre">Ctrl-]</span></code> and <code class="docutils literal"><span class="pre">Ctrl-T</span></code> is sent through the serial port.</li>
</ul>
</div>
<div class="section" id="automatically-decoding-addresses">
<h2>Automatically Decoding Addresses<a class="headerlink" href="idf-monitor.html#automatically-decoding-addresses" title="Permalink to this headline">¶</a></h2>
<p>Any time esp-idf prints a hexadecimal code address of the form <code class="docutils literal"><span class="pre">0x4_______</span></code>, idf_monitor will use <a class="reference external" href="https://sourceware.org/binutils/docs/binutils/addr2line.html">addr2line</a> to look up the source code location and function name.</p>
<p>When an esp-idf app crashes and panics a register dump and backtrace such as this is produced:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Guru Meditation Error of type StoreProhibited occurred on core  0. Exception was unhandled.
Register dump:
PC      : 0x400f360d  PS      : 0x00060330  A0      : 0x800dbf56  A1      : 0x3ffb7e00
A2      : 0x3ffb136c  A3      : 0x00000005  A4      : 0x00000000  A5      : 0x00000000
A6      : 0x00000000  A7      : 0x00000080  A8      : 0x00000000  A9      : 0x3ffb7dd0
A10     : 0x00000003  A11     : 0x00060f23  A12     : 0x00060f20  A13     : 0x3ffba6d0
A14     : 0x00000047  A15     : 0x0000000f  SAR     : 0x00000019  EXCCAUSE: 0x0000001d
EXCVADDR: 0x00000000  LBEG    : 0x4000c46c  LEND    : 0x4000c477  LCOUNT  : 0x00000000

Backtrace: 0x400f360d:0x3ffb7e00 0x400dbf56:0x3ffb7e20 0x400dbf5e:0x3ffb7e40 0x400dbf82:0x3ffb7e60 0x400d071d:0x3ffb7e90
</pre></div>
</div>
<p>idf_monitor will augment the dump:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Guru Meditation Error of type StoreProhibited occurred on core  0. Exception was unhandled.
Register dump:
PC      : 0x400f360d  PS      : 0x00060330  A0      : 0x800dbf56  A1      : 0x3ffb7e00
0x400f360d: do_something_to_crash at /home/gus/esp/32/idf/examples/get-started/hello_world/main/./hello_world_main.c:57
(inlined by) inner_dont_crash at /home/gus/esp/32/idf/examples/get-started/hello_world/main/./hello_world_main.c:52
A2      : 0x3ffb136c  A3      : 0x00000005  A4      : 0x00000000  A5      : 0x00000000
A6      : 0x00000000  A7      : 0x00000080  A8      : 0x00000000  A9      : 0x3ffb7dd0
A10     : 0x00000003  A11     : 0x00060f23  A12     : 0x00060f20  A13     : 0x3ffba6d0
A14     : 0x00000047  A15     : 0x0000000f  SAR     : 0x00000019  EXCCAUSE: 0x0000001d
EXCVADDR: 0x00000000  LBEG    : 0x4000c46c  LEND    : 0x4000c477  LCOUNT  : 0x00000000

Backtrace: 0x400f360d:0x3ffb7e00 0x400dbf56:0x3ffb7e20 0x400dbf5e:0x3ffb7e40 0x400dbf82:0x3ffb7e60 0x400d071d:0x3ffb7e90
0x400f360d: do_something_to_crash at /home/gus/esp/32/idf/examples/get-started/hello_world/main/./hello_world_main.c:57
(inlined by) inner_dont_crash at /home/gus/esp/32/idf/examples/get-started/hello_world/main/./hello_world_main.c:52
0x400dbf56: still_dont_crash at /home/gus/esp/32/idf/examples/get-started/hello_world/main/./hello_world_main.c:47
0x400dbf5e: dont_crash at /home/gus/esp/32/idf/examples/get-started/hello_world/main/./hello_world_main.c:42
0x400dbf82: app_main at /home/gus/esp/32/idf/examples/get-started/hello_world/main/./hello_world_main.c:33
0x400d071d: main_task at /home/gus/esp/32/idf/components/esp32/./cpu_start.c:254
</pre></div>
</div>
<p>Behind the scenes, the command idf_monitor runs to decode each address is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>xtensa-esp32-elf-addr2line -pfia -e build/PROJECT.elf ADDRESS
</pre></div>
</div>
</div>
<div class="section" id="launch-gdb-for-gdbstub">
<h2>Launch GDB for GDBStub<a class="headerlink" href="idf-monitor.html#launch-gdb-for-gdbstub" title="Permalink to this headline">¶</a></h2>
<p>By default, if an esp-idf app crashes then the panic handler prints registers and a stack dump as shown above, and then resets.</p>
<p>Optionally, the panic handler can be configured to run a serial &#8220;gdb stub&#8221; which can communicate with a <a class="reference external" href="https://sourceware.org/gdb/download/onlinedocs/">gdb</a> debugger program and allow memory to be read, variables and stack frames examined, etc. This is not as versatile as JTAG debugging, but no special hardware is required.</p>
<p>To enable the gdbstub, run <code class="docutils literal"><span class="pre">make</span> <span class="pre">menuconfig</span></code> and set <a class="reference internal" href="../api-reference/kconfig.html#config-esp32-panic"><span class="std std-ref">ESP32_PANIC</span></a> option to <code class="docutils literal"><span class="pre">Invoke</span> <span class="pre">GDBStub</span></code>.</p>
<p>If this option is enabled and idf_monitor sees the gdb stub has loaded, it will automatically pause serial monitoring and run GDB with the correct arguments. After GDB exits, the board will be reset via the RTS serial line (if this is connected.)</p>
<p>Behind the scenes, the command idf_monitor runs is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>xtensa-esp32-elf-gdb -ex &quot;set serial baud BAUD&quot; -ex &quot;target remote PORT&quot; -ex interrupt build/PROJECT.elf
</pre></div>
</div>
</div>
<div class="section" id="quick-compile-and-flash">
<h2>Quick Compile and Flash<a class="headerlink" href="idf-monitor.html#quick-compile-and-flash" title="Permalink to this headline">¶</a></h2>
<p>The keyboard shortcut <code class="docutils literal"><span class="pre">Ctrl-T</span> <span class="pre">Ctrl-F</span></code> will pause idf_monitor, run the <code class="docutils literal"><span class="pre">make</span> <span class="pre">flash</span></code> target, then resume idf_monitor. Any changed source files will be recompiled before re-flashing.</p>
<p>The keyboard shortcut <code class="docutils literal"><span class="pre">Ctrl-T</span> <span class="pre">Ctrl-A</span></code> will pause idf-monitor, run the <code class="docutils literal"><span class="pre">make</span> <span class="pre">app-flash</span></code> target, then resume idf_monitor. This is similar to <code class="docutils literal"><span class="pre">make</span> <span class="pre">flash</span></code>, but only the main app is compiled and reflashed.</p>
</div>
<div class="section" id="quick-reset">
<h2>Quick Reset<a class="headerlink" href="idf-monitor.html#quick-reset" title="Permalink to this headline">¶</a></h2>
<p>The keyboard shortcut <code class="docutils literal"><span class="pre">Ctrl-T</span> <span class="pre">Ctrl-R</span></code> will reset the target board via the RTS line (if it is connected.)</p>
</div>
<div class="section" id="simple-monitor">
<h2>Simple Monitor<a class="headerlink" href="idf-monitor.html#simple-monitor" title="Permalink to this headline">¶</a></h2>
<p>Earlier versions of ESP-IDF used the <a class="reference external" href="https://github.com/pyserial/pyserial">pySerial</a> command line program <a class="reference external" href="https://pyserial.readthedocs.org/en/latest/tools.html#module-serial.tools.miniterm">miniterm</a> as a serial console program.</p>
<p>This program can still be run, via <code class="docutils literal"><span class="pre">make</span> <span class="pre">simple_monitor</span></code>.</p>
<p>idf_monitor is based on miniterm and shares the same basic keyboard shortcuts.</p>
</div>
<div class="section" id="known-issues-with-idf-monitor">
<h2>Known Issues with idf_monitor<a class="headerlink" href="idf-monitor.html#known-issues-with-idf-monitor" title="Permalink to this headline">¶</a></h2>
<div class="section" id="issues-observed-on-windows">
<h3>Issues Observed on Windows<a class="headerlink" href="idf-monitor.html#issues-observed-on-windows" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>If you are using the supported Windows environment and receive the error &#8220;winpty: command not found&#8221; then run <code class="docutils literal"><span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">winpty</span></code> to fix.</li>
<li>Arrow keys and some other special keys in gdb don&#8217;t work, due to Windows Console limitations.</li>
<li>Occasionally when &#8220;make&#8221; exits, it may stall for up to 30 seconds before idf_monitor resumes.</li>
<li>Occasionally when &#8220;gdb&#8221; is run, it may stall for a short time before it begins communicating with the gdbstub.</li>
</ul>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="toolchain-setup-scratch.html" class="btn btn-neutral float-right" title="Customized Setup of Toolchain" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="eclipse-setup-windows.html" class="btn btn-neutral" title="Eclipse IDE on Windows" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 - 2017, Espressif.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v3.0-dev-806-gde750e9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>